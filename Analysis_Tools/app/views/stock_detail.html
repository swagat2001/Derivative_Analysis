{% extends "base.html" %}
{% block title %}{{ ticker }} Option Chain Analysis{% endblock %}

{% block content %}

<!-- ============================= -->
<!-- 🔗 Component & Page Styles -->
<!-- ============================= -->
<link rel="stylesheet" href="{{ url_for('static', filename='css/stock_detail.css') }}">
<link rel="stylesheet" href="{{ url_for('static', filename='css/stock_detail_header.css') }}">
<link rel="stylesheet" href="{{ url_for('static', filename='css/stock_detail_expiry.css') }}">
<link rel="stylesheet" href="{{ url_for('static', filename='css/stock_detail_stats.css') }}">
<link rel="stylesheet" href="{{ url_for('static', filename='css/stock_detail_chart.css') }}">
<link rel="stylesheet" href="{{ url_for('static', filename='css/stock_detail_option_chain.css') }}">
<link rel="stylesheet" href="{{ url_for('static', filename='css/stock_detail_gauges.css') }}">

<!-- ============================= -->
<!-- 🌐 Universal Header -->
<!-- ============================= -->
{% include 'dashboard_header.html' %}

<!-- ============================= -->
<!-- 📈 Stock Detail Section -->
<!-- ============================= -->
<div class="stock-detail-container" data-ticker="{{ ticker }}" data-date="{{ selected_date }}">

  {% if data %}

  <!-- 🧱 Top Section (Expiry Summary + Gauges + Stats) -->
  <div class="top-section">
    
    <!-- 📅 Left Column: Expiry Summary -->
    <div class="top-card left-column">
      {% include 'stock_detail_expiry.html' %}
    </div>

    <!-- ⚙️ Middle Column: Gauges + Metrics -->
    <div class="top-card middle-column">
      {% include 'stock_detail_gauges.html' %}
    </div>

    <!-- 📊 Right Column: Key Statistics -->
    <div class="top-card right-column">
      {% include 'stock_detail_stats.html' %}
    </div>
  </div>

  <!-- 📈 Price Chart -->
  {% include 'stock_detail_chart.html' %}

  <!-- 📘 Option Chain Table -->
  {% include 'stock_detail_option_chain.html' %}

  {% else %}
  <p class="no-data">No stock details found for {{ ticker }} on {{ selected_date }}</p>
  {% endif %}

</div>

<!-- ============================= -->
<!-- 📜 Header Shrink Script -->
<!-- ============================= -->
<script>
window.addEventListener('scroll', function() {
  const header = document.querySelector('.dashboard-header');
  if (window.scrollY > 50) header.classList.add('shrink');
  else header.classList.remove('shrink');
});
</script>

<!-- ============================= -->
<!-- ⚙️ ApexCharts + Custom JS -->
<!-- ============================= -->
<script src="https://cdn.jsdelivr.net/npm/apexcharts"></script>
<script src="{{ url_for('static', filename='js/stock_detail_gauges.js') }}"></script>

{% endblock %}
